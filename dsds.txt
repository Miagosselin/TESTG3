-- KingGen HUB - All-in-One Pastebin Script
-- Auteur: ChatGPT
-- Version optimisée pour l'affichage Ordinateur

local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local Player = Players.LocalPlayer
local UserId = Player.UserId
local PlaceId = game.PlaceId
local CoreGui = game:GetService("CoreGui")
local queueteleport = syn and syn.queue_on_teleport or queue_on_teleport or (fluxus and fluxus.queue_on_teleport)

-- [Fonctions et Variables Globales]
local function addShadow(parent)
    local shadow = Instance.new("ImageLabel", parent)
    shadow.Name = "Shadow"
    shadow.Image = "rbxassetid://1316045217"
    shadow.Size = UDim2.new(1, 12, 1, 12)
    shadow.Position = UDim2.new(0, -6, 0, -6)
    shadow.BackgroundTransparency = 1
    shadow.ImageTransparency = 0.7
    shadow.ZIndex = parent.ZIndex - 1
    return shadow
end

local config = {
    FreeKey = "CLONEFIX",
    PermKeys = {
        {key = "PERxxxM1", used = false, userid = nil},
        {key = "PExxxRM2", used = false, userid = nil},
        {key = "PERwwM3", used = false, userid = nil},
        {key = "PEsssRM4", used = false, userid = nil},
        {key = "PExxRM5", used = false, userid = nil},
    },
    SuperPermKey = "SUPERxxPERM"
}

local function fetchScript(url)
    local success, result = pcall(function()
        return game:HttpGet(url, true)
    end)
    if success and result and result ~= "" then
        return result
    else
        return nil
    end
end

local gameScripts = {
    [16656664443] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [15666650878] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [79243087103999] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [4543855070] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [76944637102068] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [12997619803] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [118396261129211] = fetchScript("https://raw.githubusercontent.com/sst31576-spec/ASDSDASSADSA/refs/heads/main/SADSADSAD"),
    [94282122066477] = fetchScript("https://pastebin.com/raw/x8JTfbKZ"),
    [18642553859] = fetchScript("https://pastebin.com/raw/99cDESLz")
}

-- [Fonction Principale]
local function launchGui()
    if CoreGui:FindFirstChild("KeySystemUI") then CoreGui.KeySystemUI:Destroy() end
    if CoreGui:FindFirstChild("KeyButton") then CoreGui.KeyButton:Destroy() end

    local createMainGui 

    local function createKButton()
        local ScreenGui = Instance.new("ScreenGui", CoreGui)
        ScreenGui.Name = "KeyButton"
        ScreenGui.ResetOnSpawn = false

        local KButton = Instance.new("TextButton", ScreenGui)
        KButton.Size = UDim2.new(0, 50, 0, 50)
        KButton.Position = UDim2.new(0.05, 0, 0.05, 0)
        KButton.BackgroundColor3 = Color3.fromRGB(47, 49, 54)
        KButton.Text = "K"
        KButton.TextColor3 = Color3.fromRGB(240, 71, 71)
        KButton.Font = Enum.Font.GothamBold
        KButton.TextScaled = true
        KButton.ZIndex = 5
        Instance.new("UICorner", KButton).CornerRadius = UDim.new(1, 0)
        addShadow(KButton)

        local dragging, dragInput, dragStart, startPos
        KButton.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = KButton.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then dragging = false end
                end)
            end
        end)
        KButton.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                local delta = input.Position - dragStart
                local newX = math.clamp(startPos.X.Offset + delta.X, 0, workspace.CurrentCamera.ViewportSize.X - KButton.AbsoluteSize.X)
                local newY = math.clamp(startPos.Y.Offset + delta.Y, 0, workspace.CurrentCamera.ViewportSize.Y - KButton.AbsoluteSize.Y)
                KButton.Position = UDim2.new(0, newX, 0, newY)
            end
        end)
        KButton.MouseButton1Click:Connect(function()
            ScreenGui:Destroy()
            if createMainGui then createMainGui() end
        end)
    end
    
    createMainGui = function() 
        local ScreenGui = Instance.new("ScreenGui", CoreGui)
        ScreenGui.Name = "KeySystemUI"
        ScreenGui.ResetOnSpawn = false

        local Frame = Instance.new("Frame", ScreenGui)
        Frame.Size = UDim2.new(0, 400, 0, 300)
        Frame.Position = UDim2.new(0.5, -200, 0.5, -150)
        Frame.BackgroundColor3 = Color3.fromRGB(54, 57, 63)
        Frame.BorderSizePixel = 0
        Frame.ZIndex = 2
        Instance.new("UICorner", Frame).CornerRadius = UDim.new(0, 14)
        addShadow(Frame)

        local TitleHolder = Instance.new("Frame", Frame)
        TitleHolder.Size = UDim2.new(1, 0, 0, 46)
        TitleHolder.BackgroundColor3 = Color3.fromRGB(47, 49, 54)
        TitleHolder.ZIndex = 3
        Instance.new("UICorner", TitleHolder).CornerRadius = UDim.new(0, 14)
        
        local Title = Instance.new("TextLabel", TitleHolder)
        Title.Size = UDim2.new(1, -80, 1, 0)
        Title.Position = UDim2.new(0, 20, 0, 0)
        Title.Text = "KingGen HUB" 
        Title.TextColor3 = Color3.fromRGB(233, 236, 239)
        Title.BackgroundTransparency = 1
        Title.TextScaled = true
        Title.Font = Enum.Font.GothamSemibold
        Title.ZIndex = 4

        local Close = Instance.new("TextButton", TitleHolder)
        Close.Size = UDim2.new(0, 30, 0, 30)
        Close.Position = UDim2.new(1, -34, 0, 8)
        Close.Text = "X"
        Close.TextColor3 = Color3.fromRGB(220, 53, 69)
        Close.BackgroundColor3 = Color3.fromRGB(64, 68, 75)
        Close.ZIndex = 4
        Instance.new("UICorner", Close).CornerRadius = UDim.new(0, 12)
        Close.Font = Enum.Font.GothamBold
        Close.TextScaled = true
        Close.MouseButton1Click:Connect(function() ScreenGui:Destroy() end)

        local ReduceBtn = Instance.new("TextButton", TitleHolder)
        ReduceBtn.Size = UDim2.new(0, 30, 0, 30)
        ReduceBtn.Position = UDim2.new(1, -70, 0, 8)
        ReduceBtn.Text = "-"
        ReduceBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        ReduceBtn.BackgroundColor3 = Color3.fromRGB(240, 71, 71)
        ReduceBtn.ZIndex = 4
        Instance.new("UICorner", ReduceBtn).CornerRadius = UDim.new(0, 12)
        ReduceBtn.Font = Enum.Font.GothamBold
        ReduceBtn.TextScaled = true
        ReduceBtn.MouseButton1Click:Connect(function() ScreenGui:Destroy(); createKButton() end)

        local KeyBox = Instance.new("TextBox", Frame)
        KeyBox.PlaceholderText = "Enter your key"
        KeyBox.Size = UDim2.new(0.85, 0, 0, 38)
        KeyBox.Position = UDim2.new(0.075, 0, 0.25, 0)
        KeyBox.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeyBox.BackgroundColor3 = Color3.fromRGB(64, 68, 75)
        KeyBox.Font = Enum.Font.Gotham
        KeyBox.ZIndex = 3
        Instance.new("UICorner", KeyBox).CornerRadius = UDim.new(0, 8)

        local SubmitBtn = Instance.new("TextButton", Frame)
        SubmitBtn.Text = "Validate"
        SubmitBtn.Size = UDim2.new(0.7, 0, 0, 36)
        SubmitBtn.Position = UDim2.new(0.15, 0, 0.42, 0)
        SubmitBtn.BackgroundColor3 = Color3.fromRGB(240, 71, 71)
        SubmitBtn.Font = Enum.Font.GothamBold
        SubmitBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        SubmitBtn.ZIndex = 3
        Instance.new("UICorner", SubmitBtn).CornerRadius = UDim.new(0, 8)

        local Status = Instance.new("TextLabel", Frame)
        Status.Size = UDim2.new(1, -24, 0, 32)
        Status.Position = UDim2.new(0, 12, 0.72, 0)
        Status.TextColor3 = Color3.fromRGB(233, 236, 239)
        Status.TextScaled = true
        Status.BackgroundTransparency = 1
        Status.Font = Enum.Font.Gotham
        Status.ZIndex = 3

        local InfoText = Instance.new("TextLabel", Frame)
        InfoText.Text = "(If the correct key or script doesn’t work, your executor is not supported)"
        InfoText.Size = UDim2.new(1, -24, 0, 28)
        InfoText.Position = UDim2.new(0, 12, 0.85, 0)
        InfoText.TextColor3 = Color3.fromRGB(180, 180, 180)
        InfoText.TextScaled = true
        InfoText.BackgroundTransparency = 1
        InfoText.Font = Enum.Font.Gotham
        InfoText.ZIndex = 3

        local DiscordBox = Instance.new("TextBox", Frame)
        DiscordBox.Text = "https://discord.gg/RhDnUQr4Du"
        DiscordBox.Size = UDim2.new(0.55, 0, 0, 30)
        DiscordBox.Position = UDim2.new(0.11, 0, 0.60, 0)
        DiscordBox.BackgroundColor3 = Color3.fromRGB(64, 68, 75)
        DiscordBox.TextColor3 = Color3.fromRGB(102, 123, 160)
        DiscordBox.Font = Enum.Font.Gotham
        DiscordBox.ZIndex = 3
        Instance.new("UICorner", DiscordBox).CornerRadius = UDim.new(0, 8)

        local CopyBtn = Instance.new("TextButton", Frame)
        CopyBtn.Text = "Copy"
        CopyBtn.Size = UDim2.new(0.18, 0, 0, 30)
        CopyBtn.Position = UDim2.new(0.69, 0, 0.60, 0)
        CopyBtn.BackgroundColor3 = Color3.fromRGB(240, 71, 71)
        CopyBtn.Font = Enum.Font.Gotham
        CopyBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        CopyBtn.ZIndex = 3
        Instance.new("UICorner", CopyBtn).CornerRadius = UDim.new(0, 8)
        CopyBtn.MouseButton1Click:Connect(function()
            setclipboard("https://discord.gg/RhDnUQr4Du")
            Status.Text = "Discord link copied!"
        end)

        local dragging, dragInput, dragStart, startPos
        TitleHolder.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = Frame.Position
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then dragging = false end
                end)
            end
        end)
        TitleHolder.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)
        UserInputService.InputChanged:Connect(function(input)
            if input == dragInput and dragging then
                local delta = input.Position - dragStart
                Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)

        SubmitBtn.MouseButton1Click:Connect(function()
            local input = (KeyBox.Text or ""):gsub("%s+", "") 
            local valid = false
            local statusMessage = ""

            if input == config.FreeKey then
                valid, statusMessage = true, "Free key accepted!"
            elseif input == config.SuperPermKey then
                valid, statusMessage = true, "Super key accepted!"
            else
                for _, v in ipairs(config.PermKeys) do
                    if v.key == input then
                        if not v.used then
                            v.used, v.userid = true, UserId
                            valid, statusMessage = true, "Key accepted! (Not saved)"
                        elseif v.userid == UserId then
                            valid, statusMessage = true, "Key already linked to you!"
                        else
                            statusMessage = "Key already used by another user."
                        end
                        break
                    end
                end
            end
            
            Status.Text = statusMessage

            if valid then
                ScreenGui:Destroy()
                local scriptCode = gameScripts[PlaceId]
                if scriptCode and scriptCode ~= "" then
                    local func, err = loadstring(scriptCode)
                    if func then
                        func()
                    else
                        Player:Kick("Error loading game script: "..err)
                    end
                else
                    Player:Kick("This game is not supported.")
                end
            else
                Status.Text = Status.Text or "Invalid key!"
            end
        end)
    end

    launchGui()
end

-- Exécution
launchGui()

-- Gestion du téléport
if queueteleport then
    queueteleport(function()
        task.wait(5)
        launchGui()
    end)
end
